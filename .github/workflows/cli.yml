# Generated by ChatGPT (No copyright claimed)
name: HydeCLI

on:
  workflow_dispatch:
    inputs:
      command:
        type: choice
        description: 'Select a command to execute'
        options: 
          - php hyde list
          - php hyde build
          - php hyde rebuild
          - php hyde validate
          - php hyde build:rss
          - php hyde build:search
          - php hyde build:sitemap
          - php hyde make:page
          - php hyde make:post
          - php hyde publish:configs
          - php hyde publish:homepage
          - php hyde publish:views
          - php hyde route:list
          - php hyde torchlight:install
          - php hyde vendor:publish
        required: true

      arguments:
        description: 'Optional arguments to append to the command'
        required: false

permissions:
  contents: write
  
jobs:
  execute_command:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v2

      - name: Composer install
        run: composer install
      
      - name: Execute command
        run: |
          # Parse command input
          command="${{ github.event.inputs.command }}"
          arguments="${{ github.event.inputs.arguments }}"

          # Combine command with arguments
          full_command="${command} ${arguments}"

          # Execute the command
          echo "Executing command: $full_command"
          $full_command

      - name: Commit changes
        run: |
          git config --global user.name "GitHub Actions"
          git config --global user.email "actions@github.com"
          git add .
          git commit -m "Commit changes from HydeCLI command"
          git push
          # todo fix this not triggering the build action workflow
